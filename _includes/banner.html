<div id='banner'></div>

<script>
banner = SVG('banner')
logo = banner.link('/')
rects = []
victim = 0
anim = {
  delay: Math.random(100),
  duration: Math.random(100)
}

opacity = 0.5

rect = logo.defs()
           .rect(1, 1)
           .stroke({width: 0.1})
           .addClass('front')

shade = logo.defs()
            .rect(1, 1)
            .stroke({width: 0.05})
            .addClass('shade')

$.getJSON('/assets/images/logos/pikesley.svg.json', function(data) {
  banner.viewbox({
    x: 0,
    y: 0,
    width: data['width'],
    height: data['height']
  })

  $.each(data['data'], function(i, points) {
    banner.use(shade).move(points['x'], points['y'])
    rects[i] = {
      x: points['x'],
      y: points['y'],
      rect: logo.use(rect).move(points['x'], points['y'])
    }
  })
})

window.onload = function start() {
  //victim = Math.floor(Math.random() * rects.length)
  //rects[victim].rect.animate(anim).opacity(opacity)
  //glitch();
  flicker()
}

function glitch() {
  window.setInterval(function() {
    //rects[victim].rect
    //            .animate(anim)
    //            .opacity(1)
    mover = Math.floor(Math.random() * rects.length)
    rects[mover].rect
                .animate(anim)
                .opacity(opacity)
    victim = mover
  }, Math.random() * 60000)
}

function flicker() {
  window.setInterval(function() {
    flickerer = rects[Math.floor(Math.random() * rects.length)]
    for (i = 0; i < Math.random() * 8; i++) {
      flickerer.rect.animate(anim).opacity(opacity)
      flickerer.rect.animate(anim).opacity(1)
    }
  }, Math.random() * 60000)
}
</script>
